{"version":3,"sources":["webpack://demo/@d2phap/happla/webpack/universalModuleDefinition","webpack://demo/@d2phap/happla/src/modules/Board.ts","webpack://demo/@d2phap/happla/src/modules/helpers.ts","webpack://demo/@d2phap/happla/webpack/bootstrap","webpack://demo/webpack:/@d2phap/happla/webpack/runtime/define property getters","webpack://demo/webpack:/@d2phap/happla/webpack/runtime/hasOwnProperty shorthand","webpack://demo/webpack:/@d2phap/happla/webpack/runtime/make namespace object","webpack://demo/webpack/bootstrap","webpack://demo/webpack/runtime/compat get default export","webpack://demo/webpack/runtime/define property getters","webpack://demo/webpack/runtime/hasOwnProperty shorthand","webpack://demo/webpack/runtime/make namespace object","webpack://demo/./index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@d2phap/happla\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@d2phap/happla\"] = factory();\n\telse\n\t\troot[\"@d2phap/happla\"] = factory();\n})(this, function() {\nreturn ","import { pause } from './helpers';\r\n\r\nexport type ZoomEventFunction = (zoomFactor: number, x: number, y: number) => void;\r\nexport type TransformEventFunction = (matrix: DOMMatrix) => void;\r\nexport type PanEventFunction = (x: number, y: number) => void;\r\n\r\nexport enum InterpolationMode {\r\n  Pixelated = 'pixelated',\r\n  Auto = 'auto',\r\n  CrispEdges = '-webkit-optimize-contrast', // crisp-edges\r\n}\r\n\r\nexport interface BoardOptions {\r\n  allowZoom?: boolean;\r\n  zoomFactor?: number;\r\n  minZoom?: number;\r\n  maxZoom?: number;\r\n\r\n  allowPan?: boolean;\r\n  panOffset?: { x: number, y: number };\r\n\r\n  imageRendering?: InterpolationMode;\r\n  scaleRatio?: number;\r\n\r\n  onBeforeContentReady?: () => void;\r\n  onContentReady?: () => void;\r\n\r\n  onBeforeZoomChanged?: ZoomEventFunction;\r\n  onAfterZoomChanged?: ZoomEventFunction;\r\n  onAfterTransformed?: TransformEventFunction;\r\n\r\n  onPanning?: PanEventFunction;\r\n  onAfterPanned?: PanEventFunction;\r\n}\r\n\r\nexport class Board {\r\n  private elBoardContent: HTMLElement;\r\n  private elBoard: HTMLElement;\r\n  private domMatrix: DOMMatrix;\r\n  private isPointerDown = false;\r\n\r\n  private animationFrame: number;\r\n  private isMoving = false;\r\n  private arrowLeftDown = false;\r\n  private arrowRightDown = false;\r\n  private arrowUpDown = false;\r\n  private arrowDownDown = false;\r\n\r\n  private options: BoardOptions;\r\n  private defaultOptions: BoardOptions = {\r\n    imageRendering: InterpolationMode.Pixelated,\r\n\r\n    allowZoom: true,\r\n    minZoom: 0.1,\r\n    maxZoom: 150,\r\n    zoomFactor: 1,\r\n    panOffset: { x: 0, y: 0 },\r\n\r\n    allowPan: true,\r\n    scaleRatio: window.devicePixelRatio,\r\n\r\n    onBeforeContentReady: () => {},\r\n    onContentReady: () => {},\r\n\r\n    onBeforeZoomChanged: () => {},\r\n    onAfterZoomChanged: () => {},\r\n    onAfterTransformed: () => {},\r\n\r\n    onPanning: () => {},\r\n    onAfterPanned: () => {},\r\n  };\r\n\r\n  constructor(board: HTMLElement, boardContent: HTMLElement, options?: BoardOptions) {\r\n    this.elBoard = board;\r\n    this.elBoardContent = boardContent;\r\n\r\n    this.options = {\r\n      ...this.defaultOptions,\r\n      ...options || {},\r\n    };\r\n\r\n    this.domMatrix = new DOMMatrix()\r\n      .scaleSelf(this.options.zoomFactor)\r\n      .translateSelf(this.options.panOffset.x, this.options.panOffset.y);\r\n\r\n    this.zoomDistance = this.zoomDistance.bind(this);\r\n    this.moveDistance = this.moveDistance.bind(this);\r\n    this.startMoving = this.startMoving.bind(this);\r\n    this.stopMoving = this.stopMoving.bind(this);\r\n    this.dpi = this.dpi.bind(this);\r\n    this.updateImageRendering = this.updateImageRendering.bind(this);\r\n\r\n    this.enable = this.enable.bind(this);\r\n    this.disable = this.disable.bind(this);\r\n    this.zoomTo = this.zoomTo.bind(this);\r\n    this.panTo = this.panTo.bind(this);\r\n    this.applyTransform = this.applyTransform.bind(this);\r\n    this.waitForContentReady = this.waitForContentReady.bind(this);\r\n\r\n    this.onMouseWheel = this.onMouseWheel.bind(this);\r\n    this.onPointerDown = this.onPointerDown.bind(this);\r\n    this.onPointerUp = this.onPointerUp.bind(this);\r\n    this.onPointerMove = this.onPointerMove.bind(this);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n    this.onKeyUp = this.onKeyUp.bind(this);\r\n\r\n    this.disable();\r\n\r\n    this.elBoardContent.style.transformOrigin = 'top left';\r\n    this.elBoard.style.touchAction = 'none';\r\n    this.elBoard.style.overflow = 'hidden';\r\n\r\n    // emit event onBeforeContentReady\r\n    this.options.onBeforeContentReady();\r\n  }\r\n\r\n  // #region Getters & Setters\r\n  get imageRendering() {\r\n    return this.options.imageRendering;\r\n  }\r\n\r\n  set imageRendering(value: InterpolationMode) {\r\n    this.options.imageRendering = value;\r\n\r\n    this.updateImageRendering();\r\n  }\r\n\r\n  get scaleRatio() {\r\n    return this.options.scaleRatio;\r\n  }\r\n\r\n  set scaleRatio(value: number) {\r\n    this.options.scaleRatio = value;\r\n  }\r\n\r\n  /**\r\n   * Gets zoom factor after computing device ratio (DPI)\r\n   *\r\n   * @readonly\r\n   * @memberof Board\r\n   */\r\n  get zoomFactor() {\r\n    return this.options.zoomFactor * this.options.scaleRatio;\r\n  }\r\n  // #endregion\r\n\r\n\r\n  // #region Private functions\r\n  private onMouseWheel(e: WheelEvent) {\r\n    // ignore horizontal scroll events\r\n    if (e.deltaY === 0) {\r\n      return;\r\n    }\r\n\r\n    const direction = e.deltaY < 0 ? 'up' : 'down';\r\n    const normalizedDeltaY = 1 + Math.abs(e.deltaY) / 300; // speed\r\n    const delta = direction === 'up' ? normalizedDeltaY : 1 / normalizedDeltaY;\r\n\r\n    this.zoomDistance(delta, e.clientX, e.clientY);\r\n  }\r\n\r\n  private onPointerDown(e: PointerEvent) {\r\n    // ignore right clicks\r\n    if (e.button !== 0) {\r\n      return;\r\n    }\r\n\r\n    this.elBoard.setPointerCapture(e.pointerId);\r\n    this.isPointerDown = true;\r\n\r\n    // We get the pointer position on click so we can get the value once the user starts to drag\r\n    this.options.panOffset.x = e.clientX;\r\n    this.options.panOffset.y = e.clientY;\r\n  }\r\n\r\n  private onPointerMove(event: PointerEvent) {\r\n    // Only run this function if the pointer is down\r\n    if (!this.isPointerDown) {\r\n      return;\r\n    }\r\n\r\n    this.moveDistance(\r\n      event.clientX - this.options.panOffset.x,\r\n      event.clientY - this.options.panOffset.y,\r\n    );\r\n\r\n    this.options.panOffset.x = event.clientX;\r\n    this.options.panOffset.y = event.clientY;\r\n\r\n    this.options.onPanning(this.domMatrix.e, this.domMatrix.f);\r\n  }\r\n\r\n  private onPointerUp(e: PointerEvent) {\r\n    if (!this.isPointerDown) {\r\n      return;\r\n    }\r\n\r\n    this.elBoard.releasePointerCapture(e.pointerId);\r\n    this.isPointerDown = false;\r\n\r\n    this.options.panOffset.x += e.clientX - this.options.panOffset.x;\r\n    this.options.panOffset.y += e.clientY - this.options.panOffset.y;\r\n\r\n    this.options.onAfterPanned(this.domMatrix.e, this.domMatrix.f);\r\n  }\r\n\r\n  private onKeyDown(event: KeyboardEvent) {\r\n    switch (event.key) {\r\n      case 'ArrowLeft':\r\n        this.arrowLeftDown = true;\r\n        if (!this.isMoving) {\r\n          this.isMoving = true;\r\n          this.startMoving();\r\n        }\r\n        break;\r\n      case 'ArrowUp':\r\n        this.arrowUpDown = true;\r\n        if (!this.isMoving) {\r\n          this.isMoving = true;\r\n          this.startMoving();\r\n        }\r\n        break;\r\n      case 'ArrowRight':\r\n        this.arrowRightDown = true;\r\n        if (!this.isMoving) {\r\n          this.isMoving = true;\r\n          this.startMoving();\r\n        }\r\n        break;\r\n      case 'ArrowDown':\r\n        this.arrowDownDown = true;\r\n        if (!this.isMoving) {\r\n          this.isMoving = true;\r\n          this.startMoving();\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  private onKeyUp(event: KeyboardEvent) {\r\n    switch (event.key) {\r\n      case 'ArrowLeft':\r\n        this.arrowLeftDown = false;\r\n        break;\r\n      case 'ArrowUp':\r\n        this.arrowUpDown = false;\r\n        break;\r\n      case 'ArrowRight':\r\n        this.arrowRightDown = false;\r\n        break;\r\n      case 'ArrowDown':\r\n        this.arrowDownDown = false;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    if ([\r\n      this.arrowLeftDown,\r\n      this.arrowUpDown,\r\n      this.arrowRightDown,\r\n      this.arrowDownDown,\r\n    ].every((keyDown) => !keyDown)) {\r\n      this.stopMoving();\r\n    }\r\n  }\r\n\r\n  private dpi(value: number) {\r\n    return value / this.options.scaleRatio;\r\n  }\r\n\r\n  private updateImageRendering() {\r\n    switch (this.imageRendering) {\r\n      case InterpolationMode.Auto:\r\n        if (this.zoomFactor <= 1.0) {\r\n          this.elBoardContent.style.imageRendering = InterpolationMode.CrispEdges;\r\n        }\r\n        else {\r\n          this.elBoardContent.style.imageRendering = InterpolationMode.Pixelated;\r\n        }\r\n        break;\r\n\r\n      default:\r\n        this.elBoardContent.style.imageRendering = this.imageRendering;\r\n        break;\r\n    }\r\n  }\r\n\r\n  private moveDistance(x = 0, y = 0) {\r\n    // Update the transform coordinates with the distance from origin and current position\r\n    this.domMatrix.e += x;\r\n    this.domMatrix.f += y;\r\n\r\n    this.options.onPanning(this.domMatrix.e, this.domMatrix.f);\r\n\r\n    this.applyTransform();\r\n  }\r\n\r\n  private zoomDistance(delta: number, dx?: number, dy?: number, duration?: number) {\r\n    if (!this.options.allowZoom) {\r\n      return;\r\n    }\r\n\r\n    // update the current zoom factor\r\n    this.options.zoomFactor = this.domMatrix.a;\r\n\r\n    const oldZoom = this.options.zoomFactor;\r\n    const newZoom = oldZoom * delta;\r\n\r\n    // raise event onBeforeZoomChanged\r\n    this.options.onBeforeZoomChanged(this.zoomFactor, this.domMatrix.e, this.domMatrix.f);\r\n\r\n    // restrict the zoom factor\r\n    this.options.zoomFactor = Math.min(\r\n      Math.max(this.options.minZoom, newZoom),\r\n      this.options.maxZoom,\r\n    );\r\n\r\n    const newX = (dx ?? this.elBoard.offsetLeft) - this.elBoard.offsetLeft;\r\n    const newY = (dy ?? this.elBoard.offsetTop) - this.elBoard.offsetTop;\r\n    let newDelta = delta;\r\n\r\n    // check zoom -> maxZoom\r\n    if (newZoom * this.options.scaleRatio > this.options.maxZoom) {\r\n      newDelta = this.dpi(this.options.maxZoom) / oldZoom;\r\n      this.options.zoomFactor = this.dpi(this.options.maxZoom);\r\n    }\r\n\r\n    // check zoom -> minZoom\r\n    else if (newZoom * this.options.scaleRatio < this.options.minZoom) {\r\n      newDelta = this.dpi(this.options.minZoom) / oldZoom;\r\n      this.options.zoomFactor = this.dpi(this.options.minZoom);\r\n    }\r\n\r\n    this.domMatrix = new DOMMatrix()\r\n      .translateSelf(newX, newY)\r\n      .scaleSelf(newDelta)\r\n      .translateSelf(-newX, -newY)\r\n      .multiplySelf(this.domMatrix);\r\n\r\n    // raise event onAfterZoomChanged\r\n    this.options.onAfterZoomChanged(this.zoomFactor, this.domMatrix.e, this.domMatrix.f);\r\n\r\n\r\n    this.updateImageRendering();\r\n    this.applyTransform(duration);\r\n  }\r\n\r\n  private startMoving() {\r\n    const speed = 20;\r\n    let x = 0;\r\n    let y = 0;\r\n\r\n    if (this.arrowLeftDown && !this.arrowRightDown) {\r\n      x = speed;\r\n    } else if (!this.arrowLeftDown && this.arrowRightDown) {\r\n      x = -speed;\r\n    }\r\n\r\n    if (this.arrowUpDown && !this.arrowDownDown) {\r\n      y = speed;\r\n    } else if (!this.arrowUpDown && this.arrowDownDown) {\r\n      y = -speed;\r\n    }\r\n\r\n    this.moveDistance(x, y);\r\n    this.animationFrame = requestAnimationFrame(this.startMoving);\r\n  }\r\n\r\n  private stopMoving() {\r\n    cancelAnimationFrame(this.animationFrame);\r\n    this.isMoving = false;\r\n  }\r\n  // #endregion\r\n\r\n\r\n  // #region Public functions\r\n  public async panTo(x: number, y: number, duration?: number) {\r\n    this.domMatrix.e = x;\r\n    this.domMatrix.f = y;\r\n\r\n    await this.applyTransform(duration);\r\n  }\r\n\r\n  public async zoomTo(factor: number, x?: number, y?: number, duration?: number) {\r\n    // restrict the zoom factor\r\n    this.options.zoomFactor = Math.min(\r\n      Math.max(this.options.minZoom, this.dpi(factor)),\r\n      this.options.maxZoom,\r\n    );\r\n\r\n    // raise event onBeforeZoomChanged\r\n    this.options.onBeforeZoomChanged(this.zoomFactor, this.domMatrix.e, this.domMatrix.f);\r\n\r\n    // apply scale and translate value\r\n    this.domMatrix.a = this.options.zoomFactor;\r\n    this.domMatrix.d = this.options.zoomFactor;\r\n    this.domMatrix.e = x || 0;\r\n    this.domMatrix.f = y || 0;\r\n\r\n    // raise event onAfterZoomChanged\r\n    this.options.onAfterZoomChanged(this.zoomFactor, this.domMatrix.e, this.domMatrix.f);\r\n\r\n    this.updateImageRendering();\r\n    await this.applyTransform(duration);\r\n  }\r\n\r\n  public applyTransform(duration: number = 0) {\r\n    return new Promise((resolve) => {\r\n      this.elBoardContent.style.transform = `${this.domMatrix.toString()}`;\r\n\r\n      // apply animation\r\n      if (duration > 0) {\r\n        const transition = `transform ${duration}ms ease, opacity ${duration}ms ease`;\r\n        this.elBoardContent.style.transition = transition;\r\n\r\n        setTimeout(resolve, duration);\r\n      }\r\n      else {\r\n        this.elBoardContent.style.transition = '';\r\n        resolve(undefined);\r\n      }\r\n    })\r\n      .then(() => {\r\n        // raise event\r\n        this.options.onAfterTransformed(this.domMatrix);\r\n      });\r\n  }\r\n\r\n  public enable() {\r\n    this.applyTransform();\r\n\r\n    this.elBoard.addEventListener('wheel', this.onMouseWheel, { passive: true });\r\n\r\n    this.elBoard.addEventListener('pointerdown', this.onPointerDown);\r\n    this.elBoard.addEventListener('pointerup', this.onPointerUp);\r\n    this.elBoard.addEventListener('pointerleave', this.onPointerUp);\r\n    this.elBoard.addEventListener('pointermove', this.onPointerMove);\r\n\r\n    this.elBoard.addEventListener('keydown', this.onKeyDown);\r\n    this.elBoard.addEventListener('keyup', this.onKeyUp);\r\n  }\r\n\r\n  public disable() {\r\n    this.elBoard.removeEventListener('mousewheel', this.onMouseWheel);\r\n\r\n    this.elBoard.removeEventListener('pointerdown', this.onPointerDown);\r\n    this.elBoard.removeEventListener('pointerup', this.onPointerUp);\r\n    this.elBoard.removeEventListener('pointerleave', this.onPointerUp);\r\n    this.elBoard.removeEventListener('pointermove', this.onPointerMove);\r\n\r\n    this.elBoard.removeEventListener('keydown', this.onKeyDown);\r\n    this.elBoard.removeEventListener('keyup', this.onKeyUp);\r\n  }\r\n\r\n  public async waitForContentReady() {\r\n    const list = this.elBoardContent.querySelectorAll('img');\r\n    const imgs = Array.from(list);\r\n\r\n    while (imgs.some((i) => !i.complete)) {\r\n      // eslint-disable-next-line\r\n      await pause(10);\r\n    }\r\n\r\n    // emit event onContentReady\r\n    this.options.onContentReady();\r\n  }\r\n  // #endregion\r\n}\r\n","\r\nexport interface IRect {\r\n  left: number;\r\n  right: number;\r\n  top: number;\r\n  bottom: number;\r\n}\r\n\r\nexport const pause = (duration: number) => new Promise((resolve) => setTimeout(resolve, duration));\r\n\r\nexport const checkRectanglesIntersection = (rectangle1: IRect, rectangle2: IRect) => !(\r\n  rectangle2.left > rectangle1.right\r\n  || rectangle2.right < rectangle1.left\r\n  || rectangle2.top > rectangle1.bottom\r\n  || rectangle2.bottom < rectangle1.top\r\n);\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// @ts-nocheck\r\nimport { Board, InterpolationMode, PanEventFunction, ZoomEventFunction } from '@d2phap/happla';\r\n\r\nconst elBoard = document.getElementById('board');\r\nconst elWrapper = document.getElementById('wrapper');\r\nconst elBoardContent = document.getElementById('boardContent');\r\n\r\nconst elScaleRatio = document.getElementById('elScaleRatio');\r\nconst elZoom = document.getElementById('elZoom');\r\nconst elX = document.getElementById('elX');\r\nconst elY = document.getElementById('elY');\r\nconst elWidth = document.getElementById('elWidth');\r\nconst elHeight = document.getElementById('elHeight');\r\n\r\n\r\nconst onAfterZoomChanged: ZoomEventFunction = (factor: number, x: number, y: number) => {\r\n  elScaleRatio.innerText = board.scaleRatio;\r\n  elZoom.innerText = factor;\r\n  elX.innerText = x;\r\n  elY.innerText = y;\r\n  elWidth.innerText = `${elBoardContent.clientWidth * factor}px (${elBoardContent.clientWidth}px)`;\r\n  elHeight.innerText = `${elBoardContent.clientHeight * factor}px (${elBoardContent.clientHeight}px)`;\r\n};\r\n\r\nconst onPanning: PanEventFunction = (x: number, y: number) => {\r\n  elX.innerText = x;\r\n  elY.innerText = y;\r\n};\r\n\r\nconst onBeforeContentReady = () => {\r\n  elWrapper.style.opacity = 0;\r\n  elWrapper.style.transition = 'opacity ease 0ms';\r\n};\r\n\r\nconst onContentReady = () => {\r\n  // elBoardContent.style.opacity = 1;\r\n  // elBoardContent.style.transition = '';\r\n};\r\n\r\n\r\nconst board = new Board(elBoard, elBoardContent, {\r\n  onAfterZoomChanged,\r\n  onPanning,\r\n  onBeforeContentReady,\r\n  onContentReady,\r\n});\r\n\r\n\r\nboard.imageRendering = InterpolationMode.Auto;\r\nboard.waitForContentReady()\r\n  .then(async () => {\r\n    board.enable();\r\n\r\n    const w = elBoardContent.scrollWidth / board.scaleRatio;\r\n    const h = elBoardContent.scrollHeight / board.scaleRatio;\r\n\r\n    const widthScale = elBoard.clientWidth / w;\r\n    const heightScale = elBoard.clientHeight / h;\r\n    const scale = Math.min(widthScale, heightScale);\r\n\r\n    const x = (elBoard.offsetWidth - (w * scale)) / 2;\r\n    const y = (elBoard.offsetHeight - (h * scale)) / 2;\r\n\r\n    await board.panTo(-w/2, -h/2);\r\n    board.zoomTo(scale, x, y);\r\n\r\n    elWrapper.style.opacity = 1;\r\n  });\r\n\r\n// const img = document.getElementById('img');\r\n\r\n// var poll = new Promise((resolve) => {\r\n//   setInterval(function () {\r\n//     if (img.naturalWidth) {\r\n//       clearInterval(poll);\r\n\r\n//       resolve({\r\n//         width: img.naturalWidth,\r\n//         height: img.naturalHeight,\r\n//       });\r\n//     }\r\n//   }, 5);\r\n// });\r\n\r\n// poll.then(async ({ width, height }) => {\r\n//   board.imageRendering = InterpolationMode.Pixelated;\r\n//   console.log(board.imageRendering);\r\n\r\n//   board.enable();\r\n\r\n//   const w = elBoardContent.scrollWidth;\r\n//   const h = elBoardContent.scrollHeight;\r\n\r\n//   const widthScale = elBoard.clientWidth / w;\r\n//   const heightScale = elBoard.clientHeight / h;\r\n//   const scale = Math.min(widthScale, heightScale);\r\n\r\n//   const x = (elBoard.offsetWidth - (w * scale)) / 2;\r\n//   const y = (elBoard.offsetHeight - (h * scale)) / 2;\r\n\r\n//   console.log(`${x}, ${y}`);\r\n//   await board.zoomTo(scale, x, y);\r\n\r\n//   // board.panTo(0, 0);\r\n// });\r\n\r\n"],"sourceRoot":""}